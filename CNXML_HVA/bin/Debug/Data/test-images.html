<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Hi·ªÉn Th·ªã H√¨nh ·∫¢nh</title>
    <script src="js/app.js"></script>
    <script src="js/crud.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
      }
      .section {
        background: white;
        padding: 20px;
        margin: 20px 0;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      .card {
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        background: white;
      }
      .card img {
        width: 100%;
        height: 200px;
        object-fit: cover;
      }
      .card-body {
        padding: 15px;
      }
      .success {
        color: green;
      }
      .error {
        color: red;
      }
      h2 {
        color: #333;
        border-bottom: 2px solid #4caf50;
        padding-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üñºÔ∏è Test Hi·ªÉn Th·ªã H√¨nh ·∫¢nh</h1>
      <p>Ki·ªÉm tra vi·ªác load v√† hi·ªÉn th·ªã h√¨nh ·∫£nh t·ª´ XML</p>

      <div class="section">
        <h2>Chi Nh√°nh (Branches)</h2>
        <div id="branchesResult"></div>
        <div id="branchesGrid" class="grid"></div>
      </div>

      <div class="section">
        <h2>Thi·∫øt B·ªã (Equipments)</h2>
        <div id="equipmentsResult"></div>
        <div id="equipmentsGrid" class="grid"></div>
      </div>

      <div class="section">
        <h2>S√¢n B√≥ng (Fields)</h2>
        <div id="fieldsResult"></div>
        <div id="fieldsGrid" class="grid"></div>
      </div>

      <div class="section">
        <h2>üìä Console Logs</h2>
        <p>M·ªü Developer Console (F12) ƒë·ªÉ xem chi ti·∫øt</p>
        <button onclick="runAllTests()">üîÑ Ch·∫°y L·∫°i Test</button>
      </div>
    </div>

    <script>
      const crudManager = new CRUDManager();

      async function testBranches() {
        console.log("=== Testing Branches ===");
        const resultDiv = document.getElementById("branchesResult");
        const gridDiv = document.getElementById("branchesGrid");

        try {
          const data = await crudManager.getMergedData(
            "Branches.xml",
            "branch"
          );
          resultDiv.innerHTML = `<p class="success">‚úÖ Loaded ${data.length} branches</p>`;

          gridDiv.innerHTML = data
            .map(
              (branch) => `
                <div class="card">
                  <img src="${
                    branch.image_url ||
                    "https://via.placeholder.com/400x200?text=No+Image"
                  }" 
                       alt="${branch.name}"
                       onerror="this.src='https://via.placeholder.com/400x200?text=Error+Loading'">
                  <div class="card-body">
                    <h3>${branch.name || "N/A"}</h3>
                    <p><strong>ID:</strong> ${branch.id || "N/A"}</p>
                    <p><strong>Code:</strong> ${branch.code || "N/A"}</p>
                    <p><strong>Image URL:</strong> ${
                      branch.image_url ? "‚úÖ C√≥" : "‚ùå Kh√¥ng c√≥"
                    }</p>
                    <small style="color: #999; word-break: break-all;">${
                      branch.image_url || "No URL"
                    }</small>
                  </div>
                </div>
              `
            )
            .join("");

          console.log("‚úÖ Branches loaded:", data);
        } catch (error) {
          resultDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
          console.error("‚ùå Branches error:", error);
        }
      }

      async function testEquipments() {
        console.log("=== Testing Equipments ===");
        const resultDiv = document.getElementById("equipmentsResult");
        const gridDiv = document.getElementById("equipmentsGrid");

        try {
          const data = await crudManager.getMergedData(
            "Equipments.xml",
            "equipment"
          );
          resultDiv.innerHTML = `<p class="success">‚úÖ Loaded ${data.length} equipments</p>`;

          gridDiv.innerHTML = data
            .map(
              (equipment) => `
                <div class="card">
                  <img src="${
                    equipment.image_url ||
                    "https://via.placeholder.com/400x200?text=No+Image"
                  }" 
                       alt="${equipment.name}"
                       onerror="this.src='https://via.placeholder.com/400x200?text=Error+Loading'">
                  <div class="card-body">
                    <h3>${equipment.name || "N/A"}</h3>
                    <p><strong>ID:</strong> ${equipment.id || "N/A"}</p>
                    <p><strong>Category:</strong> ${
                      equipment.category || "N/A"
                    }</p>
                    <p><strong>Image URL:</strong> ${
                      equipment.image_url ? "‚úÖ C√≥" : "‚ùå Kh√¥ng c√≥"
                    }</p>
                    <small style="color: #999; word-break: break-all;">${
                      equipment.image_url || "No URL"
                    }</small>
                  </div>
                </div>
              `
            )
            .join("");

          console.log("‚úÖ Equipments loaded:", data);
        } catch (error) {
          resultDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
          console.error("‚ùå Equipments error:", error);
        }
      }

      async function testFields() {
        console.log("=== Testing Fields ===");
        const resultDiv = document.getElementById("fieldsResult");
        const gridDiv = document.getElementById("fieldsGrid");

        try {
          const data = await crudManager.getMergedData("Fields.xml", "field");
          resultDiv.innerHTML = `<p class="success">‚úÖ Loaded ${data.length} fields</p>`;

          gridDiv.innerHTML = data
            .map(
              (field) => `
                <div class="card">
                  <img src="${
                    field.image_url ||
                    "https://via.placeholder.com/400x200?text=Football+Field"
                  }" 
                       alt="${field.name}"
                       onerror="this.src='https://via.placeholder.com/400x200?text=Error+Loading'">
                  <div class="card-body">
                    <h3>${field.name || "N/A"}</h3>
                    <p><strong>ID:</strong> ${field.id || "N/A"}</p>
                    <p><strong>Type ID:</strong> ${
                      field.field_type_id || "N/A"
                    }</p>
                    <p><strong>Image URL:</strong> ${
                      field.image_url ? "‚úÖ C√≥" : "‚ùå Kh√¥ng c√≥"
                    }</p>
                    <small style="color: #999; word-break: break-all;">${
                      field.image_url || "No URL"
                    }</small>
                  </div>
                </div>
              `
            )
            .join("");

          console.log("‚úÖ Fields loaded:", data);
        } catch (error) {
          resultDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
          console.error("‚ùå Fields error:", error);
        }
      }

      async function runAllTests() {
        await testBranches();
        await testEquipments();
        await testFields();
      }

      // Run on load
      window.addEventListener("DOMContentLoaded", runAllTests);
    </script>
  </body>
</html>
